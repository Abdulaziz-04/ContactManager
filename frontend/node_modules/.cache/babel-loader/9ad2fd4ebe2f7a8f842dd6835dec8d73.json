{"ast":null,"code":"import _slicedToArray from\"/home/abdul/Documents/Reactprog/ContactManager/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/home/abdul/Documents/Reactprog/ContactManager/frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/abdul/Documents/Reactprog/ContactManager/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useReducer}from'react';import authContext from'./authContext';import authReducer from'./authReducer';import axios from'axios';import{LOGIN_FAIL,LOGIN_SUCCESS,LOGOUT,REGISTER_FAIL,REGISTER_SUCCESS,AUTH_ERROR,CLEAR_ERRORS,USER_LOADED}from'../types';import Authtoken from'../../Components/Authtoken';var AuthState=function AuthState(props){var initialState={user:null,token:localStorage.getItem('token'),isAuth:null,error:null,loading:true};var register=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(formData){var config,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:config={header:{'Content-Type':'application/json'}};_context.prev=1;_context.next=4;return axios.post('/api/users',formData,config);case 4:res=_context.sent;dispatch({type:REGISTER_SUCCESS,payload:res.data});loadUser();_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);dispatch({type:REGISTER_FAIL,payload:_context.t0.response.data.msg});case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function register(_x){return _ref.apply(this,arguments);};}();var loadUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(localStorage.token){Authtoken(localStorage.token);}_context2.prev=1;_context2.next=4;return axios.get('/api/login');case 4:res=_context2.sent;dispatch({type:USER_LOADED,payload:res.data});_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);dispatch({type:AUTH_ERROR,payload:_context2.t0.response.data.msg});case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function loadUser(){return _ref2.apply(this,arguments);};}();var login=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(formData){var config,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:config={header:{'Content-Type':'application/json'}};_context3.prev=1;_context3.next=4;return axios.post('/api/login',formData,config);case 4:res=_context3.sent;dispatch({type:LOGIN_SUCCESS,payload:res.data});loadUser();_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](1);dispatch({type:LOGIN_FAIL,payload:_context3.t0.response.data.msg});case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[1,9]]);}));return function login(_x2){return _ref3.apply(this,arguments);};}();var logout=function logout(){dispatch({type:LOGOUT});};var clearError=function clearError(){dispatch({type:CLEAR_ERRORS});};var _useReducer=useReducer(authReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];return React.createElement(authContext.Provider,{value:{user:state.user,error:state.error,isAuth:state.isAuth,token:state.token,loading:state.loading,register:register,clearError:clearError,loadUser:loadUser,login:login,logout:logout}},props.children);};export default AuthState;","map":{"version":3,"sources":["/home/abdul/Documents/Reactprog/ContactManager/frontend/src/ContextAPI/Auth/AuthState.js"],"names":["React","useReducer","authContext","authReducer","axios","LOGIN_FAIL","LOGIN_SUCCESS","LOGOUT","REGISTER_FAIL","REGISTER_SUCCESS","AUTH_ERROR","CLEAR_ERRORS","USER_LOADED","Authtoken","AuthState","props","initialState","user","token","localStorage","getItem","isAuth","error","loading","register","formData","config","header","post","res","dispatch","type","payload","data","loadUser","response","msg","get","login","logout","clearError","state","children"],"mappings":"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","sourcesContent":["import React, { useReducer } from 'react';\nimport authContext from './authContext';\nimport authReducer from './authReducer';\nimport axios from 'axios';\nimport {\n    LOGIN_FAIL,\n    LOGIN_SUCCESS,\n    LOGOUT,\n    REGISTER_FAIL,\n    REGISTER_SUCCESS,\n    AUTH_ERROR,\n    CLEAR_ERRORS,\n    USER_LOADED\n} from '../types';\nimport Authtoken from '../../Components/Authtoken';\n\nconst AuthState = props => {\n    const initialState = {\n        user: null,\n        token: localStorage.getItem('token'),\n        isAuth: null,\n        error: null,\n        loading: true\n    };\n    const register = async formData => {\n        const config = {\n            header: {\n                'Content-Type': 'application/json'\n            }\n        };\n        try {\n            const res = await axios.post('/api/users', formData, config);\n            dispatch({ type: REGISTER_SUCCESS, payload: res.data });\n            loadUser();\n        } catch (err) {\n            dispatch({ type: REGISTER_FAIL, payload: err.response.data.msg });\n        }\n    };\n    const loadUser = async () => {\n        if (localStorage.token) {\n            Authtoken(localStorage.token);\n        }\n        try {\n            const res = await axios.get('/api/login');\n            dispatch({ type: USER_LOADED, payload: res.data });\n        } catch (err) {\n            dispatch({ type: AUTH_ERROR, payload: err.response.data.msg });\n        }\n    };\n    const login = async formData => {\n        const config = {\n            header: {\n                'Content-Type': 'application/json'\n            }\n        };\n        try {\n            const res = await axios.post('/api/login', formData, config);\n            dispatch({ type: LOGIN_SUCCESS, payload: res.data });\n            loadUser();\n        } catch (err) {\n            dispatch({ type: LOGIN_FAIL, payload: err.response.data.msg });\n        }\n    };\n    const logout = () => {\n        dispatch({ type: LOGOUT });\n    };\n    const clearError = () => {\n        dispatch({ type: CLEAR_ERRORS });\n    };\n\n    const [state, dispatch] = useReducer(authReducer, initialState);\n    return (\n        <authContext.Provider\n            value={{\n                user: state.user,\n                error: state.error,\n                isAuth: state.isAuth,\n                token: state.token,\n                loading: state.loading,\n                register,\n                clearError,\n                loadUser,\n                login,\n                logout\n            }}\n        >\n            {props.children}\n        </authContext.Provider>\n    );\n};\n\nexport default AuthState;\n"]},"metadata":{},"sourceType":"module"}